# å…ƒå¾ Â· åˆä¼™äººèµ‹èƒ½å¹³å°

> è®°å½•åä½œã€é‡åŒ–è´¡çŒ®ã€è¿æ¥äººè„‰çš„å†…éƒ¨åŸºç¡€è®¾æ–½

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

å…ƒå¾ Â· åˆä¼™äººèµ‹èƒ½å¹³å°æ˜¯ä¸€ä¸ªç”¨äºè®°å½•åˆä¼™äººåä½œã€é‡åŒ–è´¡çŒ®ã€å¯è§†åŒ–é¡¹ç›®ä¸å¹³å°ä»·å€¼çš„å†…éƒ¨åŸºç¡€è®¾æ–½ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **è®°å½•åä½œ**ï¼šé¡¹ç›®/éœ€æ±‚/å“åº”/ä¼šè®®/äººè„‰çš„ç»“æ„åŒ–è®°å½•
- **é‡åŒ–è´¡çŒ®**ï¼šToken è´¦æœ¬ + åº§è°ˆä¼šé‚€è¯·å¥–åŠ±
- **è¿æ¥äººè„‰**ï¼šäººè„‰èµ„æºè¡¨å•ç»„ä»¶åŒ–ã€å¼•èå…¥å£
- **å¼ºè§¦è¾¾é€šçŸ¥**ï¼šç«™å†…ä¿¡ç®± + Email åŒé€šé“

### æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šNode.js + Express + TypeScript + Prisma
- **å‰ç«¯**ï¼šReact + Vite + TypeScript + TailwindCSS
- **æ•°æ®åº“**ï¼šPostgreSQL
- **å®¹å™¨åŒ–**ï¼šDocker + Docker Compose

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- pnpm >= 8.0.0
- Docker & Docker Composeï¼ˆå¯é€‰ï¼Œæ¨èï¼‰
- PostgreSQL >= 15ï¼ˆå¦‚ä¸ä½¿ç”¨ Dockerï¼‰

### æ–¹å¼ä¸€ï¼šDocker Composeï¼ˆæ¨èï¼‰

æœ€å¿«10åˆ†é’Ÿå†…å®Œæˆç¯å¢ƒæ­å»ºï¼š

```bash
# 1. å…‹éš†é¡¹ç›®
cd platform

# 2. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 3. ç­‰å¾…æœåŠ¡å¯åŠ¨å®Œæˆåè®¿é—®
# å‰ç«¯: http://localhost:5173
# åç«¯: http://localhost:3000
# å¥åº·æ£€æŸ¥: http://localhost:3000/health
```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘

#### 1. å®‰è£…ä¾èµ–

```bash
# åç«¯
cd backend
pnpm install

# å‰ç«¯
cd ../frontend
pnpm install
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# åç«¯
cd backend
cp env.template .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰
```

#### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
cd backend

# ç”Ÿæˆ Prisma Client
pnpm db:generate

# æ‰§è¡Œæ•°æ®åº“è¿ç§»
pnpm db:migrate

# åˆå§‹åŒ–ç§å­æ•°æ®
pnpm db:seed
```

#### 4. å¯åŠ¨æœåŠ¡

```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨åç«¯
cd backend
pnpm dev

# ç»ˆç«¯2ï¼šå¯åŠ¨å‰ç«¯
cd frontend
pnpm dev
```

#### 5. è®¿é—®åº”ç”¨

- å‰ç«¯ï¼šhttp://localhost:5173
- åç«¯ APIï¼šhttp://localhost:3000/api/v1
- Prisma Studioï¼š`pnpm db:studio`

### æµ‹è¯•è´¦å·

| è§’è‰² | é‚®ç®± | å¯†ç  |
|------|------|------|
| ç®¡ç†å‘˜ | admin@yuanzheng.com | admin123 |
| è”åˆåˆ›å§‹äºº | founder@yuanzheng.com | founder123 |
| æ ¸å¿ƒåˆä¼™äºº | core@yuanzheng.com | core123 |
| æ™®é€šåˆä¼™äºº | partner@yuanzheng.com | partner123 |

## ğŸ“ é¡¹ç›®ç»“æ„

```
platform/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.ts             # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config/            # é…ç½®
â”‚   â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ traceId.ts     # Trace ID
â”‚   â”‚   â”‚   â”œâ”€â”€ requestLogger.ts
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.ts
â”‚   â”‚   â”œâ”€â”€ modules/           # ä¸šåŠ¡æ¨¡å—ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ db.ts          # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ errors.ts      # é”™è¯¯å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ logger.ts      # æ—¥å¿—
â”‚   â”‚   â””â”€â”€ test/              # æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma      # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â””â”€â”€ seed.ts            # ç§å­æ•°æ®
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ frontend/                   # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx           # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.tsx            # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ components/        # é€šç”¨ç»„ä»¶ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”‚   â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰ Hooksï¼ˆå¾…å®ç°ï¼‰
â”‚   â”‚   â”œâ”€â”€ stores/            # çŠ¶æ€ç®¡ç†ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”‚   â”œâ”€â”€ api/               # API å®¢æˆ·ç«¯ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”‚   â””â”€â”€ styles/            # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml             # CI æµæ°´çº¿
â”‚
â”œâ”€â”€ docker-compose.yml          # Docker Compose é…ç½®
â””â”€â”€ README.md
```

## ğŸ›  å¼€å‘æŒ‡å—

### å¸¸ç”¨å‘½ä»¤

#### åç«¯

```bash
# å¼€å‘æ¨¡å¼
pnpm dev

# æ„å»º
pnpm build

# ä»£ç æ£€æŸ¥
pnpm lint
pnpm lint:fix

# æµ‹è¯•
pnpm test
pnpm test:watch
pnpm test:coverage

# æ•°æ®åº“
pnpm db:generate   # ç”Ÿæˆ Prisma Client
pnpm db:migrate    # æ‰§è¡Œè¿ç§»
pnpm db:push       # åŒæ­¥ schema åˆ°æ•°æ®åº“
pnpm db:seed       # åˆå§‹åŒ–ç§å­æ•°æ®
pnpm db:studio     # æ‰“å¼€ Prisma Studio
```

#### å‰ç«¯

```bash
# å¼€å‘æ¨¡å¼
pnpm dev

# æ„å»º
pnpm build

# é¢„è§ˆæ„å»ºç»“æœ
pnpm preview

# ä»£ç æ£€æŸ¥
pnpm lint
pnpm lint:fix

# æµ‹è¯•
pnpm test
```

### æ·»åŠ æ•°æ®åº“è¿ç§»

```bash
# ä¿®æ”¹ prisma/schema.prisma å
pnpm db:migrate --name your_migration_name
```

### API è§„èŒƒ

æ‰€æœ‰ API å“åº”éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

```typescript
// æˆåŠŸå“åº”
{
  "success": true,
  "data": { ... },
  "traceId": "uuid"
}

// é”™è¯¯å“åº”
{
  "success": false,
  "error": {
    "code": 1001,
    "message": "é”™è¯¯æè¿°",
    "details": { ... }  // å¯é€‰
  },
  "traceId": "uuid"
}

// åˆ†é¡µå“åº”
{
  "success": true,
  "data": [ ... ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "total": 100,
    "totalPages": 5
  },
  "traceId": "uuid"
}
```

### é”™è¯¯ç èŒƒå›´

| èŒƒå›´ | æ¨¡å— |
|------|------|
| 1xxx | é€šç”¨é”™è¯¯ |
| 2xxx | è®¤è¯ç›¸å…³ |
| 3xxx | ç”¨æˆ·ç›¸å…³ |
| 4xxx | é¡¹ç›®ç›¸å…³ |
| 5xxx | éœ€æ±‚ç›¸å…³ |
| 6xxx | å“åº”ç›¸å…³ |
| 7xxx | Token ç›¸å…³ |
| 8xxx | èµ„æºç›¸å…³ |
| 9xxx | ä¼šè®®/æ—¥å†ç›¸å…³ |
| 10xxx | å¯è§æ€§ç›¸å…³ |
| 11xxx | é€šçŸ¥ç›¸å…³ |

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# åç«¯æµ‹è¯•
cd backend
pnpm test

# å‰ç«¯æµ‹è¯•
cd frontend
pnpm test
```

### CI æµæ°´çº¿

æ¯æ¬¡ PR ä¼šè‡ªåŠ¨è¿è¡Œï¼š
- âœ… ESLint ä»£ç æ£€æŸ¥
- âœ… TypeScript ç±»å‹æ£€æŸ¥
- âœ… å•å…ƒæµ‹è¯•
- âœ… æ•°æ®åº“è¿ç§»æ£€æŸ¥
- âœ… Docker æ„å»ºæµ‹è¯•

## ğŸ“Š å·¥ç¨‹éªŒæ”¶ Gate Checklist

æ ¹æ® PRD è¦æ±‚ï¼Œæ¯ä¸ªå¼€å‘èŠ‚ç‚¹éœ€é€šè¿‡ä»¥ä¸‹ 20 æ¡æ£€æŸ¥ï¼š

1. âœ… æƒé™ï¼šæ‰€æœ‰æ¥å£éƒ½æœ‰æœåŠ¡ç«¯é‰´æƒ
2. âœ… å¯è§æ€§ï¼šæ‰€æœ‰è¯»æ¥å£éƒ½èµ°ç»Ÿä¸€ visibility è¿‡æ»¤
3. âœ… ä½å±‚ä¸å±è”½é«˜å±‚ï¼šCUSTOM ä¿å­˜æ—¶åç«¯å¼ºåˆ¶åˆå¹¶é«˜å±‚ç”¨æˆ·
4. âœ… å®¡è®¡ï¼šæ¶‰åŠæ•æ„Ÿå¯¹è±¡çš„å˜æ›´/åˆ é™¤æœ‰ AuditLog
5. âœ… è½¯åˆ ä¸€è‡´æ€§ï¼šis_deleted ååˆ—è¡¨ä¸å¯è§
6. âœ… å¹‚ç­‰ï¼šæ‰€æœ‰"çŠ¶æ€æ”¹å˜å‹"æ¥å£æ”¯æŒå¹‚ç­‰
7. âœ… äº‹åŠ¡ï¼šæ¶‰åŠå¤šè¡¨ä¸€è‡´æ€§æ›´æ–°å¿…é¡»åœ¨ DB äº‹åŠ¡å†…
8. âœ… é”™è¯¯ç ï¼šæœ‰ç»Ÿä¸€ error_code + message + trace_id
9. âœ… è¾“å…¥æ ¡éªŒï¼šå¿…å¡«/æ ¼å¼/èŒƒå›´æ ¡éªŒé½å…¨
10. âœ… åˆ†é¡µï¼šåˆ—è¡¨æ¥å£éƒ½æœ‰åˆ†é¡µ
11. âœ… æ’åºç¨³å®šï¼šåˆ—è¡¨æ’åºè§„åˆ™å›ºå®š
12. âœ… å¹¶å‘å®‰å…¨ï¼šå…³é”®å†™æ“ä½œæœ‰ä¿æŠ¤
13. âœ… æ—¶é—´å¤„ç†ï¼šæ‰€æœ‰æ—¶é—´ä½¿ç”¨ timestamptz
14. âœ… æ—¥å¿—ï¼šå…³é”®é“¾è·¯æœ‰ç»“æ„åŒ–æ—¥å¿—
15. âœ… å›å½’è„šæœ¬ï¼šæœ‰å¯é‡å¤çš„æµ‹è¯•ç”¨ä¾‹é›†
16. âœ… é€šçŸ¥ä¸æ¼ï¼šç«™å†…é€šçŸ¥è¦†ç›–
17. âœ… æ•°æ®ä¸€è‡´æ€§ï¼šå¤–é”®ä¸å­˜åœ¨æ—¶è¿”å›æ˜ç¡®é”™è¯¯
18. âœ… æ€§èƒ½å†’çƒŸï¼šæ ¸å¿ƒæ¥å£ P95 åœ¨ç›®æ ‡èŒƒå›´å†…
19. âœ… å¯è§‚æµ‹ï¼šç®¡ç†å‘˜èƒ½å®šä½å¤±è´¥
20. âœ… æ–‡æ¡£ï¼šAPI å’Œå…³é”®è§„åˆ™å†™å…¥æ–‡æ¡£

## ğŸ“ å¼€å‘è·¯çº¿å›¾

### Node 0ï¼šå·¥ç¨‹åº•åº§ âœ…
- [x] å‰åç«¯å·¥ç¨‹ç»“æ„
- [x] æ•°æ®åº“è¿ç§»æ¡†æ¶ï¼ˆPrismaï¼‰
- [x] CI æµæ°´çº¿
- [x] åŸºç¡€æ—¥å¿— + trace_id
- [x] ç»Ÿä¸€é”™è¯¯ç 

### Node 1ï¼šèº«ä»½ã€è§’è‰²ã€å¯è§æ€§ï¼ˆå¾…å¼€å‘ï¼‰
- [ ] ç™»å½•/æ‰¾å›å¯†ç 
- [ ] roles/user_roles
- [ ] å¯è§æ€§æ¨¡å‹
- [ ] ç”¨æˆ·èµ„æ–™/åˆä¼™äººåå½•

### Node 2-10ï¼šä¸šåŠ¡æ¨¡å—ï¼ˆå¾…å¼€å‘ï¼‰
è¯¦è§ PRD æ–‡æ¡£ç¬¬ 28 èŠ‚

## ğŸ“„ ç›¸å…³æ–‡æ¡£

- [PRD v3 äº§å“éœ€æ±‚æ–‡æ¡£](./äº§å“éœ€æ±‚)
- [API æ¥å£æ–‡æ¡£](./docs/api.md)ï¼ˆå¾…è¡¥å……ï¼‰
- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](./docs/database.md)ï¼ˆå¾…è¡¥å……ï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/your-feature`
2. æäº¤ä»£ç ï¼š`git commit -m 'feat: add your feature'`
3. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/your-feature`
4. åˆ›å»º Pull Request

### Commit è§„èŒƒ

- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼
- `refactor`: é‡æ„
- `test`: æµ‹è¯•
- `chore`: æ„å»º/å·¥å…·

## ğŸ“œ License

Private - å…ƒå¾å†…éƒ¨ä½¿ç”¨






